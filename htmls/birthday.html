<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<title>生日快乐我的小可爱~</title>
	<link rel="stylesheet" href="/dist/css/birthday.css">
</head>

<body>
	<div id="first">
		<canvas id="birthday" width="300" height="300"></canvas>
		<img src="/dist/img_sp/bg.webp" class="bg-img" alt="">
		<div class="bottom">
			<div class="_1"></div>
			<div class="_2"></div>
			<div class="_3"></div>
		</div>
	</div>
	<div id="second">
		<div class="list-icon">
			<div class="list-icon-ver"></div>
			<div class="list-icon-hor"></div>
		</div>
		<div class="list-date">
			2018.12.25.
		</div>
	</div>
	<script>
	var w = 8;
	var wh = 300;

	var width = Math.min(document.documentElement.clientWidth, 375);
	var height = Math.min(document.documentElement.clientHeight, 400);
	var $canvas = document.getElementById("birthday");
	$canvas.setAttribute("width", width);
	$canvas.setAttribute("height", height);

	//开始画  
	var x0 = width / 2;
	var y0 = height / 2;
	var ctx = $canvas.getContext("2d");

	ctx.fillStyle = "rgb(232, 116, 116)";
	// var x, y;

	var t = -3,
		_t = 3;
	var interval = setInterval(function() {
		if (t > 0) {
			clearInterval(interval);
			$canvas.className = 'floating';
		} else {
			print(ctx, t);
			t = t + 0.005;
			print(ctx, _t);
			_t = _t - 0.005;
		}
	}, 10);
	// for (var t = -3; t <= 3; t = t + 0.001) {
	// 	x = 16 * Math.pow(Math.sin(t), 3);
	// 	y = 13 * Math.cos(t) - 5 * Math.cos(t * 2) - 2 * Math.cos(t * 3) - Math.cos(t * 4);
	// 	// 倍数
	// 	x = x * w;
	// 	y = y * w;
	// 	// 屏幕中心为原点  
	// 	ctx.fillRect(x + x0, y0 - y, 1, 1);
	// }

	// ctx.translate(-75, 0);
	ctx.font = "20px Rubik";
	ctx.fillStyle = 'rgb(232, 116, 116)';
	ctx.fillText("致我的小可爱", x0 - 60, y0);

	function print(ctx, t) {
		var x, y;
		x = 16 * Math.pow(Math.sin(t), 3);
		y = 13 * Math.cos(t) - 5 * Math.cos(t * 2) - 2 * Math.cos(t * 3) - Math.cos(t * 4);
		// 倍数
		x = x * w;
		y = y * w;
		// 屏幕中心为原点  
		ctx.fillRect(x + x0, y0 - y, 1, 1);
	}
	</script>
	<script>
	var x, y;

	function start() {
		console.log('start');
		var $first = document.querySelector('#first');
		// document.querySelector('#first').style.display = 'none';
		$first.className = 'left';
		$first.addEventListener("animationend", function(e) {
			$first.style.display = 'none';
		});
	}
	document.querySelector('.bottom').addEventListener('click', function() {
		start();
	});
	document.documentElement.addEventListener('touchstart', function(e) {
		var touch = e.targetTouches && e.targetTouches[0];
		x = touch.clientX;
		y = touch.clientY;
		console.log(x, y);
	});
	document.documentElement.addEventListener('touchmove', function(e) {
		// console.log(e.targetTouches[0])
	});
	document.documentElement.addEventListener('touchend', function(e) {
		var touch = e.changedTouches && e.changedTouches[0];
		var _x = touch.clientX;
		var _y = touch.clientY;
		console.log(_x, _y);
		if (_y - y < -50) {
			start();
		}
	});
	</script>
</body>

</html>